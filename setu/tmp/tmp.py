import re
from collections import Counter

def get_symbol_ratio(s, char_count, for_spark=True):

    def is_valid_char(character):
        # Unicode ranges:
        # Latin (English): U+0041 - U+005A and U+0061 - U+007A
        # Devanagari (Hindi, Dogri, Konkani, Maithili, Marathi, Nepali, Sanskrit, Sindhi): U+0900 - U+097F
        # Bengali (covers Assamese, Bengali, Bodo, and potentially Manipuri): U+0980 - U+09FF
        # Gujarati: U+0A80 - U+0AFF
        # Gurmukhi (Punjabi): U+0A00 - U+0A7F
        # Kannada: U+0C80 - U+0CFF
        # Malayalam: U+0D00 - U+0D7F
        # Meitei (for Manipuri): U+ABC0 - U+ABFF
        # Oriya (Odia): U+0B00 - U+0B7F
        # Ol Chiki (Santhali): U+1C50 - U+1C7F
        # Arabic (covers Urdu): U+0600 - U+06FF
        # Tamil: U+0B80 - U+0BFF
        # Telugu: U+0C00 - U+0C7F
        # Arabic: U+0600 - U+06FF 
        # Arabic Supplement: U+0750 - U+077F 
        # Arabic Extended-A: U+08A0 - U+08FF 
        # Arabic Extended-B: U+0870 - U+089F 
        # Arabic Extended-C: U+10EC0 - U+10EFF 
        # Arabic Pres. Forms-A: U+FB50 - U+FDFF
        # Arabic Pres. Forms-B: U+FE70 - U+FEFF 
        # Arabic Mathematical...: U+1EE00 - U+1EEFF 
        # Indic Siyaq Numbers: U+1EC70 - U+1ECBF 
        # Ottoman Siyaq Numbers: U+1ED00 - U+1ED4F 
        # Rumi Numeral Symbols: U+10E60 - U+10E7F 
        
        pattern = (
            r'['
            r'\u0030-\u0039'
            r'\u0061-\u007A'
            r'\u0041-\u005A'
            r'\u0900-\u097F'
            r'\u0980-\u09FF'
            r'\u0A00-\u0A7F'
            r'\u0A80-\u0AFF'
            r'\u0C00-\u0C7F'
            r'\u0C80-\u0CFF'
            r'\u0D00-\u0D7F'
            r'\uABC0-\uABFF'
            r'\u0B00-\u0B7F'
            r'\u1C50-\u1C7F'
            r'\u0B80-\u0BFF'
            r'\u0600-\u06FF'
            r'\u0750-\u077F'
            r'\u08A0-\u08FF'
            r'\u0870-\u089F'
            r'\uFB50-\uFDFF'
            r'\uFE70-\uFEFF'
            r'\U00010EC0-\U00010EFF'        # for '\u', python exits at 4 hex digits and for '\U', python exits at 8 hex digits. 
            r'\U0001EE00-\U0001EEFF'
            r'\U0001EC70-\U0001ECBF'
            r'\U0001ED00-\U0001ED4F'
            r'\U00010E60-\U00010E7F'
            r']'
        )

        return re.match(pattern, character)

    invalid_characters_count = 0
    invalid_chars_found = []
    exception_list = [" ", "\n"]   
    char_counter = Counter(s)
    for char in char_counter.keys():
        if not is_valid_char(char) and char not in exception_list:
                invalid_characters_count += char_counter[char]
                invalid_chars_found += [char]
    if for_spark:
        return invalid_characters_count/char_count, invalid_characters_count
    return invalid_characters_count/char_count, invalid_characters_count, invalid_chars_found

if __name__ == "__main__":
    input_str = """
    ये है दुनिया की आलीशान ट्रेनें, इनका सफर किसी शाही सवारी से कम नहीं\nडिजिटल डेस्क। ज्यादातर लोग ट्रेन में सफर करते है ट्रेन में सफर करना काफी सस्ता और सुविधाजनक होता है,लेकिन दुनिया में कुछ ऐसी ट्रेनें भी है जो सबसे आलीशान हैं। इस लिस्ट में भारत की "महाराजा एक्सप्रेस" और पैलेस ऑन व्हील्स भी शामिल है। आइए देखें इन लग्जरी ट्रेनों की झलक।\n?????? ???? ?? ??? ?? ???? ??????? ?????, ?? ????? 7 ??? "World\'s Leading Travel Experience by Train" ???? ?????? ?? ????? ??? ??? ???? ????? 3 ??? ?? ?????? ?? ?? GoldLeaf,��SilverLeaf ?? RedLeaf ??? ?? ?????? ?? ??????? ?? ??? ??????? ??????, ??????? ?? ??????, ????? , ?????? ?? ???? ???\n??? ???? ?? ?????? ??????? ?? ?? ????? ??? ?????? ????????? (????? ?? ??????)?�?? ????? ??? ?????? ?? ??? ??????? ?? ??? ?????? ????? ???? ?? ???? ???? ????? Simplon ?????? ?????????????? Simplon ?????? ????????? ??? ????? ??? ?????? ?? ?? ????? ????? ??| ?? ????? ?? ??? ??? ?? ?? ?? ????? ??? ??? ?? ???? ?? ??? 2 ??????? ?? ??? ??? ??? ???? ???? ??? ?? ??? ?? ?? ?? ?? ??? ?? ???? ???? ??? ???? ?? ???? ??????? ?? ???? ????? ???? ??? ??? ???? ??? ??? ???? ????? ??? ?? ?? ????? ?? ??? ?? ?? ???? ???? ?? ????? ?? ???? ????? ???? ????? ?? ????? ?? ???????? ???? ?? ?????? napery ??? ????? ???? ???�\n?????? ???? ?? ???? ?? ?? ????? ?? ??????? ?? ?? ?? ???????? ?? ??, ?? ??? ??? ?? ??? ???? ?? ????? ??? ???? ??? ?? ????? ??? 2 ???????? ?? ???? ??????? ???????? ?? ??????? ?????????? ??? ???? ??? ?? ?????? ?? ?????? ?? ????? ???? ???? ?? ?? ?? ??????, ????????, ??????, ??????, ???????, ?????, ???? ???????, ????, ??????? ?????, ????, ???????, ???????, ???? ?? ?? ??? ?? ???? ???�?????? ????? ?? ??? ????? ??????? ?? ????? ?????? ????? $6840 ???\n???? ???? ?? ???? ?? \'??????? ?????????\' ??? ?????? ?? ????? ?? ??? ?? ????????? ???? ????? ??????? ?? ?????? ?? ??????? ??????? ??? ???? ????? ???? ???�\n????? ???? ??�??? ?? ??????? ?? ????? ???, ?? ???? ????? ???????? ?? ??? ?? ?????? ??? ????? ????? ???? ??? ????? ??? ?? ??? ??????? ?? ???? ????? ??????? ????? ??????? ??? ?????? ?????? ???? ??? ?? ??????????? ?? ??????????? ???? ?? ???? ?? ????? ??? ??| ???? ???? ?? ????? ?? ??????? ??? ????? ???? ??? ?? ????? ??????????, ???????, ????, ?????????? ?????, ?? ?? ????? (????????), ??????????? (????????) ?? ?? ??? ???? ???? ??? ??? ??? ??? ???? ???? ??? ?????? ?? ???? ???? ???? ?? ?? ?? 13,600 ???? (?????? ???), 20,500 ???? (?????? ????) ?? 27,200 ???? (???? ????) ?? ??? ??????? ????????? ????? ?? 2012 ??? �"?????? ?? ?????? ?????? ?????" ?? ??? ??? ???? ??? ??, ???? ???? 2011 ??? ??? ?????? ?? 25 ??? ??????? ??? ???? ??? ????? ???? ???? ???? ???? "???? ???? ?? ???? ???" ??? ?? 2 ???????? ?? ????\n???? ??????? ?? \'???? ?????\' ?? ????? ??? ????? ???? ?? ??? ?? ????? ??? ????? ???? ??????? ?????? ?? ??? ?? ??? \'5 ????? ???? ?? ?????\' ?? ??? ???? ??? ?? ????? ??? 8 ??? ?????????? ?? ??????? ?? ??? ???? ???\n???? ????� ?? ????? ?? ??????? ?????? ?? ???? ?????? ??????? ??? \'??????? ??? ??????? ?????????\' ???? ?????? ?? ??? ?? ????? ???????? ?? ???? ??????? ?? ??????? ?? ??? ?? ???? ???�\nCreated On : \xa0 24 Sep 2018 8:57 AM GMT
    """

    # input_str = """
    # ये है दुनिया की आलीशान ट्रेनें, इनका सफर किसी शाही सवारी से कम नहीं\nडिजिटल डेस्क। ज्यादातर लोग ट्रेन में सफर करते है ट्रेन में सफर करना काफी सस्ता और सुविधाजनक होता है,लेकिन दुनिया में कुछ ऐसी ट्रेनें भी है जो सबसे आलीशान हैं। इस लिस्ट में भारत की "महाराजा एक्सप्रेस" और पैलेस ऑन व्हील्स भी शामिल है। आइए देखें इन लग्जरी ट्रेनों की झलक।
    # """

    # input_str = """
    # '- Home\n- /\n- cpim\nसीपीआई (एम)\nGet Latest News, Breaking News about सीपीआई (एम). Stay connected to all updated on cpim\nकांग्रेस ने कहा, केरल की माकपा इकाई में सब कुछ ठीक नहीं\n- By IANS News 15 July 2023 12:06 PM GMT\nकेरल में आवारा कुत्तों का कहर: भाजपा, माकपा ने एक-दूसरे पर लगाए आरोप\n- By IANS News 14 Jun 2023 4:26 PM GMT\nमाकपा ने आईआईएम कोझिकोड में तालिबान सरकार स्टाफ के कोर्स की आचोलना की\n- By IANS News 15 March 2023 7:30 AM GMT\nमीडिया के दमन के मुद्दे पर केंद्र की आलोचना करने वाली माकपा चली उसी राह\n- By IANS News 22 Feb 2023 6:30 AM GMT\nभारत जोड़ो यात्रा के समापन समारोह में हिस्सा नहीं लेगी माकपा\n- By IANS News 20 Jan 2023 8:30 AM GMT\nसंविधान के मूल ढांचे के खिलाफ टिप्पणी भविष्य के लिए खतरनाक संकेत : माकपा\n- By IANS News 13 Jan 2023 7:30 AM GMT\nकेरल में विपक्ष ने माकपा पर माफियाओं को संरक्षण देने का लगाया आरोप\n- By IANS News 12 Jan 2023 7:30 AM GMT\nनोटबंदी पर सुप्रीम कोर्ट का फैसला इस कदम को बरकरार रखने के तौर पर नहीं देखा जा सकता: माकपा\n- By IANS News 2 Jan 2023 12:00 PM GMT'
    # """

    # input_str = """
    # 'News of Thursday, 27th May 2021\n૨૦૨૧ના બજેટમાં નાણામંત્રીએ સૂચવેલા અમુક ફેરફારો જે તા. ૧-૪-૨૦૨૧થી અમલી બનેલ છે તે સુધારા - વધારા જોઇએ.\n(૧) મકાન - ફલેટની જંત્રી કિંમતમાં રાહત :\nબાંધકામ પ્રવૃત્તિને વેગ આપવા નાણામંત્રીએ ફકત બિલ્ડરનો ધંધો કરતા મકાન - ફલેટો બનાવી વેચનારાઓને જંત્રીમાં નક્કી કરેલ રકમ કરતા ૨૦% ઓછી રકમનો દસ્તાવેજ કરે તો પણ ખરીદનારને અથવા વેચનાર બિલ્ડરને આવકવેરા કલમ ૫૦સી, ૫૬(ર) તેમજ ૪૩સીએ નીચે નોટીસ આપવામાં આવશે નહીં. અત્યાર સુધી જંત્રી કિંમતથી ૧૦% ઓછા દસ્તાવેજની છુટ હતી તે હવે ટેમ્પરરી ૨૦% સુધી તા. ૧૨-૧૦-૨૦૨૦ થી તા. ૩૦-૬-૨૦૨૧ સુધી છુટ અપાયેલ છે. પરંતુ આવો સ્થાવર મીલ્કતનો દસ્તાવેજ રૂ. ૨ કરોડ નીચેનો હોવો જરૂરી છે.\nઆ કાયદો ફકત નવા બંગલા, ફલેટ, ટેનામેન્ટ બિલ્ડર્સ દ્વારા બનાવી વેચવાવાળા ધંધાદારી બિલ્ડર્સને જ લાગુ પડે છે. તે સિવાય અન્ય કોઇ સ્થાવર - મિલ્કતના ખરીદી કે વેચાણ કરનાર વ્યકિતઓને લાગુ પડતો નથી. બિલ્ડર્સ લોબીઓએ ૩૦-૬-૨૦૨૧ પહેલા વેચાણ દસ્તાવેજ કરી લાભ લઇ શકે છે.\n(ર) ડોમેસ્ટીક કંપનીના ડીવીડન્ડ અંગે :\nડોમેસ્ટીક ભારતીય કંપનીઓ દ્વારા અત્યાર સુધી ડીવીડન્ડ ટેક્ષ ફ્રી હતું. જો કે ઇન્કમટેક્ષ ડીપાર્ટમેન્ટ ડીવીડન્ડ ચુકવતા પહેલા કંપની પાસેથી ડીવીડન્ડ ડીસ્ટ્રીબ્યુશન ટેક્ષ ઉઘરાવી લેતા હિસાબી ૨૦૨૦-૨૦૨૧માં વર્ષમાં ડીવીડન્ડ ચુકવવામાં આવતા ત્યારે ટીડીએસ કાપવામાં આવતો પરંતુ અનેક નાના - રોકાણકારોને ટીડીએસ પરત લેવા ઇન્કમટેક્ષ રીર્ટન ભરી પરત લેવામાં મુશ્કેલી નિવારવા સરકારે ટીડીએસ બંધ કરેલ છે પરંતુ ડીવીડન્ડથી મળતી આવક ગ્રોસ આવકમાં ઉમેરાશે અને કરને પાત્ર પણ બને છે.\n(૩) ટેક્ષ ઓડીટને લગતા સુધારાઓ :\nઆવકવેરા કલમ ૪૪એ બી એટલે કે ફરજીયાત ટેક્ષ ઓડીટનો કાયદો ૧૯૮૫માં સૌ પ્રથમ નાખવામાં આવેલો. જેમાં કોઇપણ વેપારી કે અન્ય કરદાતાનું વાર્ષિક ટર્નઓવર રૂ. ૪૦,૦૦,૦૦૦ (ચાલીસ લાખ)થી વધુ હોય તેમણે ચાર્ટડ - એકાઉન્ટન્ટ પાસે ઓડીટ કરાવી તેનો રીપોર્ટ ઇન્કમટેક્ષ રીર્ટન સાથે અથવા અલાઇદો ફાઇલ કરવાનો રહેતું આ રૂ. ૪૦,૦૦,૦૦૦ ટર્ન ઓવરનો કાયદો પચીસ વર્ષ એટલે કે ૨૦૧૦ સુધી તેમજ રહ્યો ત્યારબાજ તેની લીમીટ ૬૦,૦૦,૦૦૦ (સાઇઠ લાખ) કરવામાં આવી. જે વધારી ૨૦૧૩થી ૧ કરોડ કરી અને ૨૦૧૩થી પાંચ કરોડ ટર્નઓવર સુધી કરવામાં આવેલ હતી.\nઇન્કમટેક્ષ ડીપાર્ટમેન્ટની અપેક્ષા એવી હતી કે સીએ પાસે ઓડીટ કરેલા એકાઉન્ટસ તથા તેના રીપોર્ટ હોવાથી ઇન્કમટેક્ષ ઓફિસરોને આકરણી કરવામાં સરળતા રહેશે. પરંતુ તે અપેક્ષા ફળીભૂત થઇ નહીં. તેથી ૨૦૨૧થી આ લીમીટ વધારી રૂ. ૧૦ કરોડ સુધીના ટર્નઓવર સુધી કરવામાં આવી તે ઉપરાંત વ્યવસાયી વ્યકિતઓ કે વ્યવસાય કરતી પેઢી વિગેરેને રૂ. ૧૦ લાખ આવક સુધી ફરજીયાત ઓડીટ હતું તે વધારી રૂ. ૫૦ લાખ વ્યવસાયીક આવક સુધી ઓડીટ કરાવવાની જરૂરીયાત નહી રહે. આમ મોટાભાગના કરદાતાઓએ ઓડિટ નહિ કરાવવું પડે.\nઆમ, આવક વેરા ખાતુ કરદાતાઓ ઉપર જ વિશ્વાસ અને સહકારની લાગણી સાથે કાર્ય કરવાનું શરૂ કરેલ છે. હવે કુલ ફાઇલ થયેલ ઇન્કમટેક્ષ રીર્ટનમાંથી ફકત ૨% રીર્ટનમાં સ્ક્રુટીની ઓન-લાઇન આવે છે. તે પણ મોટાભાગે સરકારી કોમ્પ્યુટરોમાં કરદાતાઓએ દર્શાવેલ આવક તથા કોમ્પ્યુટરો દ્વારા શોધી કાઢેલ આવક - ખર્ચ કે રોકાણોની માહિતીમાં ફેરફાર આવે ત્યારે જ નોટીસો નીકળે છે. કરદાતાના હિસાબોમાં આવક તથા ખર્ચમાં મોટા ફેરફારો આવે અથવા ટર્નઓવર મુજબ ઘણી ઓછી આવક દર્શાવેલ હોય ત્યારે તેની પૂછપરછ થાય છે.\nનિતીન કામદાર (CA)\n૭/૯ પંચનાથ પ્લોટ, રાજકોટ.\nમો. ૯૮૨૫૨ ૧૭૮૪૮\ninfo@nitinkamdar.com'
    # """

    invalid_characters = get_symbol_ratio(input_str, len(input_str), for_spark=False)
    
    print(invalid_characters)
